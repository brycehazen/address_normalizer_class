import re

class AddressNormalizer:
    def get_street_suffix_mapping(self):
      return {
            'ALLEY': 'ALY',
            'ALLEE': 'ALY',
            'ANEX': 'ANX',
            'ANNEX': 'ANX',
            'ARCADE': 'ARC',
            'ARC': 'ARC',
            'AVENUE': 'AVE',
            'AV': 'AVE',
            'BAYOU': 'BYU',
            'BAYOO': 'BYU',
            'BEACH': 'BCH',
            'BCH': 'BCH',
            'BEND': 'BND',
            'BLUFF': 'BLF',
            'BLF': 'BLF',
            'BLUFFS': 'BLFS',
            'BOTTOM': 'BTM',
            'BOT': 'BTM',
            'BOULEVARD': 'BLVD',
            'BLVD': 'BLVD',
            'BRANCH': 'BR',
            'BR': 'BR',
            'BRIDGE': 'BRG',
            'BRDGE': 'BRG',
            'BROOK': 'BRK',
            'BRK': 'BRK',
            'BROOKS': 'BRKS',
            'BURG': 'BG',
            'BURGS': 'BGS',
            'BYPASS': 'BYP',
            'BYP': 'BYP',
            'CAMP': 'CP',
            'CANYON': 'CYN',
            'CANYN': 'CYN',
            'CAPE': 'CPE',
            'CAUSEWAY': 'CSWY',
            'CENTER': 'CTR',
            'CEN': 'CTR',
            'CENTERS': 'CTRS',
            'CIRCLE': 'CIR',
            'CIR': 'CIR',
            'CIRCLES': 'CIRS',
            'CLIFF': 'CLF',
            'CLF': 'CLF',
            'CLIFFS': 'CLFS',
            'CLFS': 'CLFS',
            'CLUB': 'CLB',
            'CLB': 'CLB',
            'COMMON': 'CMN',
            'COMMONS': 'CMNS',
            'CORNER': 'COR',
            'CONCOURSE': 'CONC',
            'COR': 'COR',
            'CORNERS': 'CORS',
            'COURSE': 'CRSE',
            'COURT': 'CT',
            'COURTS': 'CTS',
            'COVE': 'CV',
            'COVES': 'CVS',
            'CREEK': 'CRK',
            'CRESCENT': 'CRES',
            'CREST': 'CRST',
            'CROSSING': 'XING',
            'CROSSROAD': 'XRD',
            'CROSSROADS': 'XRDS',
            'CURVE': 'CURV',
            'DALE': 'DL',
            'DAM': 'DM',
            'DIVIDE': 'DV',
            'DIV': 'DV',
            'DRIVE': 'DR',
            'DR': 'DR',
            'DRIVES': 'DRS',
            'ESTATE': 'EST',
            'EST': 'EST',
            'ESTATES': 'ESTS',
            'EXPRESSWAY': 'EXPY',
            'EXP': 'EXPY',
            'EXTENSION': 'EXT',
            'EXT': 'EXT',
            'EXTENSIONS': 'EXTS',
            'EXTS': 'EXTS',
            'FALL': 'FALL',
            'FALLS': 'FLS',
            'FERRY': 'FRY',
            'FIELD': 'FLD',
            'FIELDS': 'FLDS',
            'FLAT': 'FLT',
            'FLATS': 'FLTS',
            'FORD': 'FRD',
            'FORDS': 'FRDS',
            'FOREST': 'FRST',
            'FORGE': 'FRG',
            'FORG': 'FRG',
            'FORGES': 'FRGS',
            'FORK': 'FRK',
            'FORKS': 'FRKS',
            'FORT': 'FT',
            'FREEWAY': 'FWY',
            'GARDEN': 'GDN',
            'GARDENS': 'GDNS',
            'GATEWAY': 'GTWY',
            'GLEN': 'GLN',
            'GLENS': 'GLNS',
            'GREEN': 'GRN',
            'GREENS': 'GRNS',
            'GROVE': 'GRV',
            'GROV': 'GRV',
            'GROVES': 'GRVS',
            'HARBOR': 'HBR',
            'HARB': 'HBR',
            'HARBORS': 'HBRS',
            'HAVEN': 'HVN',
            'HEIGHTS': 'HTS',
            'HT': 'HTS',
            'HIGHWAY': 'HWY',
            'HILL': 'HL',
            'HILLS': 'HLS',
            'HOLLOW': 'HOLW',
            'HLLW': 'HOLW',
            'INLET': 'INLT',
            'INLT': 'INLT',
            'ISLAND': 'IS',
            'IS': 'IS',
            'ISLANDS': 'ISS',
            'ISLE': 'ISLE',
            'JUNCTION': 'JCT',
            'JCT': 'JCT',
            'JUNCTIONS': 'JCTS',
            'JCTNS': 'JCTS',
            'KEY': 'KY',
            'KEYS': 'KYS',
            'KNOLL': 'KNL',
            'KNL': 'KNL',
            'KNOLLS': 'KNLS',
            'KNLS': 'KNLS',
            'LAKE': 'LK',
            'LK': 'LK',
            'LAKES': 'LKS',
            'LKS': 'LKS',
            'LAND': 'LAND',
            'LANDING': 'LNDG',
            'LANE': 'LN',
            'LIGHT': 'LGT',
            'LGT': 'LGT',
            'LIGHTS': 'LGTS',
            'LOAF': 'LF',
            'LF': 'LF',
            'LOCK': 'LCK',
            'LCK': 'LCK',
            'LOCKS': 'LCKS',
            'LCKS': 'LCKS',
            'LODGE': 'LDG',
            'LDG': 'LDG',
            'LOOP': 'LOOP',
            'MALL': 'MALL',
            'MANOR': 'MNR',
            'MNR': 'MNR',
            'MANORS': 'MNRS',
            'MEADOW': 'MDW',
            'MEADOWS': 'MDWS',
            'MDW': 'MDWS',
            'MEWS': 'MEWS',
            'MILL': 'ML',
            'MILLS': 'MLS',
            'MISSION': 'MSN',
            'MISSN': 'MSN',
            'MOTORWAY': 'MTWY',
            'MOUNT': 'MT',
            'MNT': 'MT',
            'MOUNTAIN': 'MTN',
            'MNTAIN': 'MTN',
            'MOUNTAINS': 'MTNS',
            'MNTNS': 'MTNS',
            'NECK': 'NCK',
            'NCK': 'NCK',
            'ORCHARD': 'ORCH',
            'ORCH': 'ORCH',
            'OVAL': 'OVAL',
            'OVERPASS': 'OPAS',
            'PARK': 'PARK',
            'PARKS': 'PARK',
            'PARKWAY': 'PKWY',
            'PARKWAYS': 'PKWY',
            'PASS': 'PASS',
            'PASSAGE': 'PSGE',
            'PATH': 'PATH',
            'PIKE': 'PIKE',
            'PINE': 'PNE',
            'PINES': 'PNES',
            'PLACE': 'PL',
            'PL': 'PL',
            'PLAIN': 'PLN',
            'PLAINS': 'PLNS',
            'PLAZA': 'PLZ',
            'POINT': 'PT',
            'POINTS': 'PTS',
            'PORT': 'PRT',
            'PORTS': 'PRTS',
            'PRAIRIE': 'PR',
            'PR': 'PR',
            'RADIAL': 'RADL',
            'RAD': 'RADL',
            'RAMP': 'RAMP',
            'RANCH': 'RNCH',
            'RAPID': 'RPD',
            'RAPIDS': 'RPDS',
            'REST': 'RST',
            'RIDGE': 'RDG',
            'RDG': 'RDG',
            'RIDGES': 'RDGS',
            'RDGS': 'RDGS',
            'RIVER': 'RIV',
            'RIV': 'RIV',
            'ROAD': 'RD',
            'RD': 'RD',
            'ROADS': 'RDS',
            'ROUTE': 'RTE',
            'ROW': 'ROW',
            'RUE': 'RUE',
            'RUN': 'RUN',
            'SHOAL': 'SHL',
            'SHL': 'SHL',
            'SHOALS': 'SHLS',
            'SHLS': 'SHLS',
            'SHORE': 'SHR',
            'SHOAR': 'SHR',
            'SHORES': 'SHRS',
            'SHOARS': 'SHRS',
            'SKYWAY': 'SKWY',
            'SPRING': 'SPG',
            'SPG': 'SPG',
            'SPRINGS': 'SPGS',
            'SPGS': 'SPGS',
            'SPUR': 'SPUR',
            'SPURS': 'SPUR',
            'SQUARE': 'SQ',
            'SQ': 'SQ',
            'SQUARES': 'SQS',
            'SQRS': 'SQS',
            'STATION': 'STA',
            'STA': 'STA',
            'STRAVENUE': 'STRA',
            'STRA': 'STRA',
            'STREAM': 'STRM',
            'STREET': 'ST',
            'STREETS': 'STS',
            'SUMMIT': 'SMT',
            'SMT': 'SMT',
            'TERRACE': 'TER',
            'TER': 'TER',
            'THROUGHWAY': 'TRWY',
            'TRACE': 'TRCE',
            'TRACK': 'TRAK',
            'TRAFFICWAY': 'TRFY',
            'TRAIL': 'TRL',
            'TRAILER': 'TRLR',
            'TUNNEL': 'TUNL',
            'TUNEL': 'TUNL',
            'TURNPIKE': 'TPKE',
            'TRNPK': 'TPKE',
            'UNDERPASS': 'UPAS',
            'UNION': 'UN',
            'UN': 'UN',
            'UNIONS': 'UNS',
            'VALLEY': 'VLY',
            'VALLEYS': 'VLYS',
            'VIADUCT': 'VIA',
            'VDCT': 'VIA',
            'VIEW': 'VW',
            'VIEWS': 'VWS',
            'VILLAGE': 'VLG',
            'VILL': 'VLG',
            'VILLAGES': 'VLGS',
            'VILLE': 'VL',
            'VISTA': 'VIS',
            'VIS': 'VIS',
            'WALK': 'WALK',
            'WALKS': 'WALK',
            'WALL': 'WALL',
            'WAY': 'WAY',
            'WY': 'WAY',
            'WAYS': 'WAYS',
            'WELL': 'WL',
            'WELLS': 'WLS',
            'NORTH': 'N',
            'EAST': 'E',
            'SOUTH': 'S',
            'WEST': 'W',
            'NORTHEAST': 'NE',
            'SOUTHEAST': 'SE',
            'NORTHWEST': 'NW',
            'SOUTHWEST': 'SW',
        }

    def normalize_address(self, address):
        if not isinstance(address, str):
            return ''  # Return empty string if address is not a string
        # Strip all formatting and remove all non-numeric characters except spaces
        address = re.sub(r'[^\w\s]', '', address.replace('\\n', ' ')).upper()
        # Apply street_suffix_mapping only to single words
        mapping = {k.upper(): v for k, v in self.get_street_suffix_mapping().items()}
        words = address.split()  # Splitting the address into individual words
        # Applying mapping to each word in the address and joining them back together
        return ' '.join([mapping.get(word.upper(), word) for word in words])
